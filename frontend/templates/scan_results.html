<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Scan Results - ByteguardX</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        .severity-critical { background-color: #ffcccc; }
        .severity-high { background-color: #ffe5b4; }
        .severity-medium { background-color: #fff9c4; }
        .severity-low { background-color: #d4edda; }
    </style>
</head>
<body>
<div class="container mt-5">
    <h2>Scan Results</h2>
    <p>Files Scanned: {{ file_count }}</p>
    <table class="table table-bordered">
        <thead>
        <tr>
            <th>File</th>
            <th>Line</th>
            <th>Issue</th>
            <th>Severity</th>
        </tr>
        </thead>
        <tbody>
        {% for f in findings %}
            {% set sev = (f.severity or f.risk or 'low').lower() %}
            <tr class="severity-{{ sev }}">
                <td>{{ f.file }}</td>
                <td>{{ f.line }}</td>
                <td>{{ f.issue_type or f.type }}</td>
                <td>{{ f.severity or f.risk }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    <form action="/download_report" method="post">
        <input type="hidden" name="findings" value="{{ findings|tojson }}">
        <input type="hidden" name="file_count" value="{{ file_count }}">
        <input type="hidden" name="project_name" value="ByteguardX">
        <button type="submit" class="btn btn-success">Download PDF Report</button>
    </form>
    <a href="/" class="btn btn-secondary mt-3">Back to Home</a>
</div>
</body>
</html> 